<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"><html><head><title>atomic-fix</title><style type="text/css">


body {
  font-family: verdana;
  margin-left: 2em;
}

p, ol {
  width: 40em;
}

li {
  margin-bottom: 0.5em;
}

pre, code {
  font-family: courier;
}

td {
  vertical-align: top;
  padding: 0 1em 0.5em 0;
}


</style></head><body><a href="/">Arc hacks</a>:<h1>atomic-fix</h1><p><i>Fixes arc2&rsquo;s atomic macro to work in the presence of exceptions.</i></p><p>arc2 has a bug where calls to <code>atomic</code> will stop being atomic after an exception is thrown inside of a call to <code>atomic</code>.  For example, after:</p><blockquote><pre>(errsafe (atomic (/ 1 0)))</pre></blockquote><p>further calls to <code>atomic</code> will no longer be atomic.  This patch fixes the bug.</p><h2>Get This Hack</h2><ul><li><a href="http://catdancer.github.com/atomic-fix.patch.txt" target="_blank">diff against arc2</a></li><li><a href="http://github.com/CatDancer/arc-atomic-fix/tree">repository on GitHub</a></li><li><a href="http://github.com/CatDancer/arc-atomic-fix/tarball/master">download a tarball of arc2 with this patch applied</a></li></ul><h2>Applying This Hack to Your Arc</h2><p>By using patch or git, you can incorporate this patch into your version of Arc.</p><h3>With patch</h3><p>To apply this patch to your copy of arc using the patch command, download <a href="http://catdancer.github.com/atomic-fix.patch">atomic-fix.patch</a> into your Arc directory, and type:</p><blockquote><pre>patch &#60;atomic-fix.patch</pre></blockquote><h3>With git</h3><p>To apply this patch using git, start with a git repository containing arc2 or the version of Arc that you want to patch.  Then in the git working directory, type:</p><blockquote><pre>git pull git://github.com/CatDancer/arc-atomic-fix.git master</pre></blockquote></body></html>
